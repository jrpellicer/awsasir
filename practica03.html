
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="practica01.html">
      
      
        <link rel="next" href="faqredes.html">
      
      
      <link rel="icon" href="images/cloud-computing.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Redes Virtuales - Prácticas en AWS para ASIR</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#redes-virtuales" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Prácticas en AWS para ASIR" class="md-header__button md-logo" aria-label="Prácticas en AWS para ASIR" data-md-component="logo">
      
  <img src="images/cloud-computing.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prácticas en AWS para ASIR
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Redes Virtuales
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Prácticas en AWS para ASIR" class="md-nav__button md-logo" aria-label="Prácticas en AWS para ASIR" data-md-component="logo">
      
  <img src="images/cloud-computing.png" alt="logo">

    </a>
    Prácticas en AWS para ASIR
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="practica00.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lanzamiento del Laboratorio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="practica01.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creación de MV
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Redes Virtuales
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Redes Virtuales
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Redes Virtuales
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="practica03.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Redes Virtuales
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objetivo-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      Objetivo del Proyecto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esquema-en-aws" class="md-nav__link">
    <span class="md-ellipsis">
      Esquema en AWS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practica-a-realizar" class="md-nav__link">
    <span class="md-ellipsis">
      Práctica a Realizar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Práctica a Realizar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eliminacion-de-la-vpc-por-defecto" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación de la VPC por defecto
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-la-nueva-vpc" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de la nueva VPC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobacion-de-los-recursos-creados" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobación de los recursos creados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tablas-de-enrutamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas de enrutamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-una-instancia-ec2-en-la-subred-publica" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de una instancia EC2 en la subred pública
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-mediante-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión mediante SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion-de-un-servidor-web" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación de un servidor web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceso-a-la-pagina-web" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso a la página web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-una-instancia-ec2-en-la-subred-privada" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de una instancia EC2 en la subred privada
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-mediante-ssh_1" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión mediante SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eliminacion-del-nat-gateaway" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación del NAT Gateaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eliminacion-de-recursos" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación de recursos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="faqredes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bases de Datos
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Bases de Datos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="practica04.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base de datos pública
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="practica05.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base de datos privada
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="practica06.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Despliegue web con Beanstalk
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objetivo-del-proyecto" class="md-nav__link">
    <span class="md-ellipsis">
      Objetivo del Proyecto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#esquema-en-aws" class="md-nav__link">
    <span class="md-ellipsis">
      Esquema en AWS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practica-a-realizar" class="md-nav__link">
    <span class="md-ellipsis">
      Práctica a Realizar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Práctica a Realizar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eliminacion-de-la-vpc-por-defecto" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación de la VPC por defecto
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-la-nueva-vpc" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de la nueva VPC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobacion-de-los-recursos-creados" class="md-nav__link">
    <span class="md-ellipsis">
      Comprobación de los recursos creados
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tablas-de-enrutamiento" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas de enrutamiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-una-instancia-ec2-en-la-subred-publica" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de una instancia EC2 en la subred pública
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-mediante-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión mediante SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion-de-un-servidor-web" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación de un servidor web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acceso-a-la-pagina-web" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso a la página web
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creacion-de-una-instancia-ec2-en-la-subred-privada" class="md-nav__link">
    <span class="md-ellipsis">
      Creación de una instancia EC2 en la subred privada
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conexion-mediante-ssh_1" class="md-nav__link">
    <span class="md-ellipsis">
      Conexión mediante SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eliminacion-del-nat-gateaway" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación del NAT Gateaway
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eliminacion-de-recursos" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminación de recursos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="redes-virtuales">Redes Virtuales</h1>
<h2 id="objetivo-del-proyecto">Objetivo del Proyecto</h2>
<p>En la práctica de creación de la Máquina Virtual hemos visto que al crear una máquina en AWS hemos utilizado una serie de recursos asociados a la red en la que se encuentra la máquina:</p>
<ul>
<li>La red virtual (VPC) de la infraestructura que estamos utilizando.</li>
<li>La subred dentro de la VPC a la que está conectada la instancia.</li>
<li>Un Internet Gateway.</li>
<li>Una tabla de enrutamiento asociada a la subred.</li>
<li>Un grupo de seguridad que ejerce de cortafuegos.</li>
<li>Una dirección IP pública para conectarnos desde el exterior.</li>
<li>Una IP elástica asociada a esa IP Pública para que sea siempre fija.</li>
</ul>
<p>En esta práctica vamos a crear de manera manual todos estos recursos para poder configurarlos según nuestras necesidades. Vamos a implementar un esquema en el que tendremos una red virtual con dos subredes (<em>subred-publica</em> y <em>subred-privada</em>). En cada una de ellas crearemos una máquina virtual Ubuntu:</p>
<ul>
<li>La primera será accesible desde el exterior de la red (desde Internet) y para ello crearemos un <strong>grupo de seguridad</strong> en el que habilitaremos el puerto 22 (ssh) y el 80 (http) para que puedan entrar desde cualquier dirección. Además necesitaremos una <strong>IP Pública</strong> y un <strong>Internet Gateway</strong> que dará salida al exterior a todos los elementos de la subred.</li>
<li>La segunda máquina estará en la <em>subred-privada</em> y configuraremos su grupo de seguridad para que sea accesible únicamente desde la <em>subred-pública</em>, sin acceso desde el exterior. Para que esta máquina tenga acceso a Internet (por ejemplo para poder hacer actualizaciones) pero no sea accesible desde Internet, necesitaremos un <strong>NAT-Gateway</strong> que se ubicará en la <em>subred-pública</em></li>
</ul>
<h2 id="esquema-en-aws">Esquema en AWS</h2>
<p><img src="images/VPC.drawio.png"></p>
<h2 id="practica-a-realizar">Práctica a Realizar</h2>
<h3 id="eliminacion-de-la-vpc-por-defecto">Eliminación de la VPC por defecto</h3>
<p>Comenzamos por eliminar la VPC creada por defecto junto con todos sus recursos asociados.</p>
<p>1.- Accedemos al panel VPC y eliminamos la VPC. Nos informa que se eliminarán 8 recursos asociados:</p>
<ul>
<li>Las 6 subredes públicas</li>
<li>El Internet Gateway</li>
<li>El Grupo de Seguridad</li>
</ul>
<p><img src="images/VPC_01.png"></p>
<hr />
<h3 id="creacion-de-la-nueva-vpc">Creación de la nueva VPC</h3>
<p>2.- Procedemos a crear la nueva VPC:</p>
<ul>
<li>Le decimos que queremos crear <strong>la VPC y más</strong>.</li>
<li>Asignamos un nombre a la VPC, por ejemplo <em>practica02</em></li>
<li>Como dirección de red (Bloque de CIDR IPv4) dejamos la 10.0.0.0/16</li>
<li>Seleccionamos una única zona de disponibilidad (AZ).</li>
<li>Le decimos que nos cree una subred pública y otra privada.</li>
<li>Personalizamos los bloques de direcciones de modo que las subredes tengan las siguientes direcciones:<ul>
<li>Subred pública: 10.0.1.0/24</li>
<li>Subred privada: 10.0.2.0/24</li>
</ul>
</li>
<li>Como deseamos que la subred privada tenga salida a Internet, creamos un <strong>Gateway NAT</strong> en 1 AZ (ojo, esto nos incrementará el coste considerablemente).</li>
<li>No vamos a conectar ningún bucket de S3, por tanto <strong>no seleccionamos</strong> ningún <em>Gateway de S3</em> en el apartado de <em>Puntos de enlace de la VPC</em>.</li>
</ul>
<p><br></p>
<p><img src="images/VPC_02.png"></p>
<p><br></p>
<hr />
<h3 id="comprobacion-de-los-recursos-creados">Comprobación de los recursos creados</h3>
<p>3.- Comprobamos los recursos creados:</p>
<ul>
<li>La VPC (<em>practica02-vpc</em>).</li>
<li>Las 2 subredes (<em>practica02-subnet-public1</em> y <em>practica02-subnet-private1</em>).</li>
<li>El Internet Gateway (<em>practica02-igw</em>).</li>
<li>Las 2 tablas de enrutamiento (una por cada subred: <em>practica02-rtb-public</em> y <em>practica02-rtb-private</em>).</li>
<li>Una tabla de enrutamiento por defecto.</li>
<li>Un Grupo de Seguridad por defecto.</li>
<li>El NAT Gateway (<em>practica02-nat-public1</em>) ubicado en la subred pública para dar salida a Internet en la subred privada.</li>
<li>Una IP Elástica asociada al NAT Gateway (<em>practica02-eip</em>).</li>
</ul>
<p><br></p>
<hr />
<h3 id="tablas-de-enrutamiento">Tablas de enrutamiento</h3>
<p>Al crearse la VPC se han creado 3 tablas de enrutamiento: una por defecto y dos asociadas a las 2 subredes que hemos creado. Las 2 tablas asociadas a las nuevas subredes son las siguientes:</p>
<p><strong>Tabla de entutamiento de la subred privada</strong></p>
<div class="admonition info inline end">
<p class="admonition-title">Uso Típico</p>
<p>Subred privada que aloja recursos como:</p>
<ul>
<li>Bases de datos, servidores de aplicaciones o backend.</li>
<li>Instancias que requieren acceso saliente a Internet (actualizaciones, APIs externas), pero que no deben recibir tráfico entrante directamente desde Internet.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th style="text-align: center;">Destino</th>
<th style="text-align: center;">Objetivo</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">10.0.0.0 /16</td>
<td style="text-align: center;">local</td>
</tr>
<tr>
<td style="text-align: center;">0.0.0.0 /16</td>
<td style="text-align: center;">nat-gateway</td>
</tr>
</tbody>
</table>
<p>Interpretación:</p>
<ul>
<li>10.0.0.0/16 -&gt; local:
        Permite que todos los recursos dentro de la VPC con dirección en el rango 10.0.0.0/16 se comuniquen entre sí sin salir de la red privada.</li>
<li>0.0.0.0/0 -&gt; NAT-Gateway:
        Redirige el tráfico saliente destinado a Internet al NAT Gateway que se encuentra en la subred pública.
        El NAT Gateway permite que las instancias en la subred privada se comuniquen con Internet sin ser directamente accesibles desde él.</li>
</ul>
<p><br></p>
<p><strong>Tabla de entutamiento de la subred pública</strong></p>
<div class="admonition info inline end">
<p class="admonition-title">Uso Típico</p>
<p>Subred pública que aloja recursos como:</p>
<ul>
<li>Servidores web o aplicaciones que necesitan acceso desde Internet.</li>
<li>Instancias EC2 con direcciones IP públicas.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th style="text-align: center;">Destino</th>
<th style="text-align: center;">Objetivo</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">10.0.0.0 /16</td>
<td style="text-align: center;">local</td>
</tr>
<tr>
<td style="text-align: center;">0.0.0.0 /16</td>
<td style="text-align: center;">Internet-gateway</td>
</tr>
</tbody>
</table>
<p>Interpretación:</p>
<ul>
<li>10.0.0.0/16 -&gt; local:
        Igual que en la tabla privada, permite la comunicación entre recursos dentro de la VPC sin salir de la red.</li>
<li>0.0.0.0/0 -&gt; Internet-Gateway:
        Define que todo el tráfico destinado a Internet (es decir, fuera del rango 10.0.0.0/16) sea redirigido al Internet Gateway.
        Este es el componente clave que convierte esta subred en una subred pública.</li>
</ul>
<p><br></p>
<hr />
<h3 id="creacion-de-una-instancia-ec2-en-la-subred-publica">Creación de una instancia EC2 en la subred pública</h3>
<p>Vamos a crear una máquina Ubuntu en la subred pública a la cual nos podremos conectar desde Internet.</p>
<p>4.- Accedemos al panel de EC2 y lanzamos una instancia.</p>
<ul>
<li>La nombramos <em>ub01</em></li>
<li>La imagen será una AMI de <em>Ubuntu 24.04 LTS</em>.</li>
<li>En tipo de instancia seleccionamos una <em>t2.micro</em> (1 CPU y 1GB de RAM) incluida en la capa gratuita.</li>
<li>Seleccionamos el par de claves <em>vockey</em> proporcionadas por el laboratorio.</li>
<li>Editamos la configuración de red.<ul>
<li>Incluimos la máquina en la subred pública creada.</li>
<li>Habilitamos la asignación de una IP Pública.</li>
<li>Creamos un grupo de seguridad (reglas de firewall) nuevo y lo llamamos <em>acceso-publico</em> y le ponemos una descripción (<em>acceso ssh a subred publica</em>)</li>
<li>Como regla de entrada dejamos la que viene por defecto que habilita el puerto 22 (SSH) desde <em>cualquier lugar</em> de Internet (0.0.0.0/0)</li>
</ul>
</li>
<li>Dejamos las opciones de almacenamiento que nos propone por defecto: 8GiB en un disco SSD de uso general.</li>
<li>Lanzamos la instancia.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Hay que tener en cuenta que la dirección IP asignada será dinámica, por lo que si deseáramos que nuestra máquina fuera, por ejemplo, un servidor web, habría que asociarle una IP elástica, que equivale a asignarle una IP pública estática.</p>
</div>
<p><br></p>
<hr />
<h3 id="conexion-mediante-ssh">Conexión mediante SSH</h3>
<p>Al crear la instancia no nos ha preguntado por ningún usuario ni contraseña en el sistema operativo. AWS crea unos usuarios por defecto que varían dependiendo del tipo de AMI seleccionada. Se pueden consultar <a href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/UserGuide/managing-users.html#ami-default-user-names">aquí</a>.</p>
<p>Para conectarnos a la máquina mediante ssh lo debemos hacer con un par de claves. En nuestro caso le hemos indicado que utilizaríamos las del laboratorio (<em>vockey</em>), por tanto el primer es descargarnos el fichero de la clave.</p>
<p>5.- Accedemos a la consola de lanzamiento del laboratorio y en <em>Detalles</em> pulsamos sobre la descarga del fichero PEM.</p>
<p><img src="images/creacion_MV_04.jpg" width=400></p>
<p>6.- Una vez descargado el fichero de clave debemos cambiar los permisos de dicho archivo:</p>
<ul>
<li>En Linux: <code>chmod 400 labuser.pem</code></li>
<li>En Windows: Dejamos únicamente los permisos para nuestro usuario, eliminando los accesos del resto de usuarios.</li>
</ul>
<p>7.- Lanzamos el ssh indicando el fichero de la clave privada descargada y sustituyendo por la url correspondiente:</p>
<pre><code>ssh -i "labuser.pem" ubuntu@ec2-204-236-197-47.compute-1.amazonaws.com
</code></pre>
<p><br></p>
<hr />
<h3 id="instalacion-de-un-servidor-web">Instalación de un servidor web</h3>
<p>Una vez dentro de la máquina vamos a instalar un servidor web.</p>
<p>8.- Ejecutamos:</p>
<pre><code>sudo apt update
sudo apt install apache2 -y
</code></pre>
<p><br></p>
<hr />
<h3 id="acceso-a-la-pagina-web">Acceso a la página web</h3>
<p>9.- Una vez instalado el servidor Apache, accedemos desde el navegador de nuestra máquina local a la dirección IP Pública de  nuestra máquina AWS.</p>
<p>A pesar de tener instalado y corriendo el servidor web, el navegador no es capaz de resolver la dirección puesto que en el firewall de la instancia (grupo de seguridad <em>acceso-publico</em>) sólo hemos permitido conexiones desde el puerto 22.</p>
<p>Vamos a permitir conexiones también del puerto 80 (http) añadiendo una nueva regla de entrada en el grupo de seguridad <em>acceso-publico</em>.</p>
<p><br>
10.- En la consola de AWS, dentro del panel de VPC, accedemos al grupo de seguridad <em>acceso-publico</em> para editar sus propiedades:</p>
<ul>
<li>En las Reglas de entrada añadimos una del tipo HTTP (Puerto TCP 80) para permitir accesos desde cualquier dirección (0.0.0.0/0).</li>
</ul>
<p><br>
11.- Guardamos las reglas y ya podemos acceder desde el navegador a la página por defecto del servidor Apache instalado en nuestra máquina.</p>
<hr />
<p><br></p>
<h3 id="creacion-de-una-instancia-ec2-en-la-subred-privada">Creación de una instancia EC2 en la subred privada</h3>
<p>Vamos a crear una máquina Ubuntu en la subred privada a la cual NO nos podremos conectar desde Internet.</p>
<p>12.- Accedemos al panel de EC2 y lanzamos una instancia.</p>
<ul>
<li>La nombramos <em>ub02</em></li>
<li>La imagen será una AMI de <em>Ubuntu 24.04 LTS</em>.</li>
<li>En tipo de instancia seleccionamos una <em>t2.micro</em> (1 CPU y 1GB de RAM) incluida en la capa gratuita.</li>
<li>Seleccionamos el par de claves <em>vockey</em> proporcionadas por el laboratorio.</li>
<li>Editamos la configuración de red.<ul>
<li>Incluimos la máquina en la subred privada creada.</li>
<li>NO habilitamos la asignación de una IP Pública.</li>
<li>Creamos un grupo de seguridad (reglas de firewall) nuevo y lo llamamos <em>acceso-privado</em> y le ponemos una descripción (<em>acceso ssh a subred privada</em>)</li>
<li>Como regla de entrada dejamos la que viene por defecto que habilita el puerto 22 (SSH) desde tipo de origen Personalizado, y como origen seleccionamos el grupo de seguridad <em>acceso-publico</em></li>
</ul>
</li>
<li>Dejamos las opciones de almacenamiento que nos propone por defecto: 8GiB en un disco SSD de uso general.</li>
<li>Lanzamos la instancia.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En el grupo de seguridad asociado a esta instancia hemos dicho que sólo se pueden admitir conexiones por ssh provenientes del grupo de seguridad <em>acceso-publico</em>, de modo que para poder conectarnos a la máquina <em>ub02</em> únicamente podremos hacerlo desde la máquina <em>ubu01</em>.</p>
</div>
<hr />
<p><br></p>
<h3 id="conexion-mediante-ssh_1">Conexión mediante SSH</h3>
<p>La máquina <em>ubu02</em> no tiene dirección pública, y además, aunque la tuviera, el grupo de seguridad solamente admite conexiones desde la subred pública, y no desde Internet.
Por todo ello, si deseamos conectarnos a esta máquina, el único modo es hacerlo desde la máquina <em>ub01</em>. Para ello necesitamos 2 requisitos:</p>
<ul>
<li>Averiguar la IP de la máquina (Sabemos que al estar en la subred privada estará en el rango de direcciones 10.0.2.0/24)</li>
<li>Pasar la clave privada (<em>labuser.pem</em>) que descargamos en nuestra máquina local a la máquina <em>ub01</em>, pues nos hará falta para conectarnos a ub02.</li>
</ul>
<p>13.- Comenzamos accediendo desde el panel de EC2 a los detalles de la instancia <em>ub02</em> copiamos la dirección IP privada.</p>
<p>14.- En segundo lugar, desde nuestra máquina host (y con la conexión ssh cerrada) copiamos el archivo labuser.pem a la máquina <em>ubu01</em> mediante el comando scp:</p>
<pre><code>scp -i labsuser.pem labsuser.pem ubuntu@ec2-18-212-203-120.compute-1.amazonaws.com:/home/ubuntu/clave_privada
</code></pre>
<p>15.- Iniciamos sesión en <em>ub01</em>:</p>
<pre><code>ssh -i "labuser.pem" ubuntu@ec2-204-236-197-47.compute-1.amazonaws.com
</code></pre>
<p>16.- Comprobamos con un ls que se ha copiado el fichero y cambiamos los permisos:</p>
<p><div class="highlight"><pre><span></span><code>ls -l
chmod 400 clave_privada
</code></pre></div>
17.- Nos conectamos con esa clave a la máquina <em>ub02</em> mediante la IP privada que anotamos:</p>
<pre><code>ssh -i clave_privada ubuntu@10.0.2.112
</code></pre>
<p>18.- Comprobamos que tenemos conexión de salida a Internet gracias al NAT Gateway:</p>
<pre><code>sudo apt update
</code></pre>
<hr />
<p><br></p>
<h3 id="eliminacion-del-nat-gateaway">Eliminación del NAT Gateaway</h3>
<p>19.- Accedemos a la consola de VPC y en Gateways NAT <strong>eliminamos el gateway</strong> (<em>practica02-nat-public1</em>) que creamos al crear la VPC.</p>
<p>20.- Intenta en <em>ubu02</em> acceder a Internet, por ejemplo actualizando los repositorios:</p>
<pre><code>sudo apt update
</code></pre>
<p>Ya hemos perdido la conexión a Internet.</p>
<hr />
<p><br></p>
<h3 id="eliminacion-de-recursos">Eliminación de recursos</h3>
<p>21.- Una vez finalizada la práctica hay que eliminar los recursos creados para que no nos consuman crédito:</p>
<ul>
<li>Comenzamos liberando la IP elástica que se asoció al NAT Gateway. Accedemos a la consola de EC2 y en IP Elásticas seleccionamos la opción <strong>Publicar dirección IP elástica</strong>. (Publicar = hacer pública = disponible).</li>
<li>Terminamos las instancias. En el panel de EC2, con la instancia seleccionada, pulsamos sobre la Acción <strong>Terminar (eliminar) instancia</strong>. Nos informa que el volumen EBS asociado también se eliminará.</li>
<li>Por último, esperamos unos minutos a que se acaben de terminar la instancias y <strong>eliminamos los grupos de seguridad</strong> <em>acceso-publico</em> y <em>acceso-privado</em>, comenzando por este último.</li>
</ul>
<p>Recuerda finalizar el laboratorio.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie" >
        
          
          <a href="practica01.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Creación de MV">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                Creación de MV
              </div>
            </div>
          </a>
        
        
          
          <a href="faqredes.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: FAQ">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                FAQ
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "content.code.annotate", "announce.dismiss", "toc.follow", "content.code.copy"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>